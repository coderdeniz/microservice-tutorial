

Tekrar

-> Mesaj ile Event arasındaki farklar
  -> mesaj: kuyruğa giden mesajda işlenmesi için gerekli datayı taşır, mesajo gönderen mesajın nasıl işleneceğini bilir.
  -> event: event'ler bir notification sistemi sağlar, event'i fırlatan onun nasıl ele alınacağını bilmez.

  -> event'te publisher broker'a gönderir ama dönüşüyle ya da ne yaptığıyla ilgilenmez.
  -> mesaj'da subscriber'in ne yapacağını bilir ve datanın dönüşünü bekler.

  -> event'ler geçmiş ile ilgili ifade edilir, ör: UserCreatedEvent, OrderCreatedEvent gibi
  -> message'lar ise örnek: WordToPdf


  -> event'ler mesaj'lara göre daha düşük boyutludur.


-> Microservice'lerde db'de data nasıl tutulmalı? 

  -> Her mikroservis db'sinde görevi için tutulacak datalarda başka microservisin db'sine bağımlı olmamalı (foreign key durumu). Örnek: OrderId, CourseName, Course price gibi
  -> Bir mikroservis başka mikroservisin db'sine doğrudan erişememelidir. Api'ler üzerinden haberleşebilmeli.


-> Microservis'ler arasında distributed transaction'i nasıl yönebiliriz?

  -> transaction, db'ye yapılan crud işlemlerinden her biridir.
  -> patterni eventual consistency(nihai tutarlılık) uygulaya yönetebiliriz. Değişlik olduğunda db'lerde gerekli işlemler yapılırken süre önemli değilse kullanılabilir.


 Catalog API 
 
 -> İçerisinde category ve course ve course'ların özelliklerini barındıran feature olacak. 
 -> Bir kategorinin birden fazla course olabilir (bir e çok ilişki)
 -> Course ile feature arasında bir e bir ilişki var.
 -> Paket: MongoDb.Driver
 -> id alanlarına: [BsonRepresentation(BsonType.ObjectId)] attribute verilmektedir.
 -> [BsonIgnore]: MongoDb'de gözardı et bunu kaydetme
 -> AutoMapper ile dto nesneleri ile entity nesneleri arası dönüştürme gerçekleştiriyoruz.
 -> Paket: AutoMapper.Extensions.Microsoft.DependencyInjection
 -> appsettings.json'da db için connectionString tanımla
 -> class'ı appsettings'deki değer ile doldur. (önce getsection ile çek configure et sonra addSingleton ile sınıfı oluştur IOptions'dan value'i çek)
 -> repository'ler yazılır.
 -> ControllerBase için ItemGroup Framework Reference eklenmelidir.
 -> Attribute'da (HttpGet) süslü ile parametre verilirse url'de ? yerine / olur.


 Identity API

 -> OpenSource kütüphane IdentityServer Framework kullanılıyor.
 -> paketi indirmek için: dotnet new -i identityserver4.templates
 -> template üzerinden projeyi oluşturuyoruz dotnet new is4aspid --name FreeCourse.IdentityServer
 -> package console manager'da add-migration initial
 -> update-database
 -> template'den gelen hazır endpointler ile token alabiliyoruz.
 -> ClientId/ClientSecret'ten gelen tokeni mvc tarafa memory'de tutabilirken user bilgisi gerekenlerde cookie benzeri yapıda tutmalıdır.


 PhotoStock.API

 -> CancellationToken, istek atıldıktan sonra foto kaydetme işinde yarım kalındıysa iptal etmede işe yarıyor.
 -> Db olmayacak, fotolar sunucudaki klasöre kaydedilecek.


 Basket.API
 
 -> Dinamik yapıya sahip olduğu için(ekleme silme çok sık) noSql db kullanmamız gerekir.
 -> Redis kullanacağız.


 Discount.API

 -> Dapper Orm ve PostgreSQL kullanılacak.
 -> Dapperin özellikleri
    -> Hafif
    -> Hızlı
    -> Kullanması basit
    -> Performanslı
    -> Any Database
    -> Simplified API, basit ara yüz
-> Ef Core'dan farkı memory'de dapper çalışmaz.



API GATEWAY

-> Bir client'tan gelen isteği ilgili mikroservise iletmekten sorumlu köprü görevi gören servistir.
-> Bir middleware diyebiliriz.
-> Authorization, Caching, Logging, RateLimiting, LoadBalance gibi işlemleri burda gerçekleştirebiliriz.
-> İlgili mikroservisi gereksiz yere yormaktan kurtarır.
-> Client her mikroservis için ip bilgisi bilmesine gerek yok api gateway üzerinden url vererek erişebilir olacak.
-> Client gateway'e upstreamdaki linkle gelecek, gateway'de downstream ile ilgili microservise gidecek.
-> Baseurl ise gatewayin kendi url




